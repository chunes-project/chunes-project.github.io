(()=>{"use strict";var t,e={263:(t,e,n)=>{var r=n(9748),i=n(885),a=n(2766),s=n(4345),o=n(5974),c=n(6720),u=n(9711),l=n(6974),h=n(2734),d=n(9695),p=n(3720),f=n(4386),Z=n(1508),y=n(3364),v=n(2658),g=n(5282),m=n(6867),w=n(2761),x=n(5861),k=n(3144),b=n(5671),I=n(4942),P=n(7757),O=n.n(P),j=n(8949),U=function t(e){(0,b.Z)(this,t),(0,I.Z)(this,"uri",""),(0,I.Z)(this,"name",null),(0,I.Z)(this,"artist",null),(0,I.Z)(this,"album",null),(0,I.Z)(this,"imageUrl",null),(0,I.Z)(this,"_signedData",null),(0,j.ky)(this),Object.assign(this,e)},S=function t(e){(0,b.Z)(this,t),(0,I.Z)(this,"userId",""),(0,I.Z)(this,"credits",0),(0,j.ky)(this),Object.assign(this,e)},D=function(){function t(){var e=this;(0,b.Z)(this,t),(0,I.Z)(this,"userId",null),(0,I.Z)(this,"userInfo",null),(0,I.Z)(this,"costs",null),(0,I.Z)(this,"playlist",[]),(0,I.Z)(this,"currentlyPlayingIndex",-1),(0,I.Z)(this,"showToast",!1),(0,I.Z)(this,"toastMessage","");var n=window.localStorage.getItem("userId");this.userId=n||null,(0,j.ky)(this),(0,j.U5)((function(){return[e.userId]}),(function(t){var e=(0,i.Z)(t,1)[0];e&&window.localStorage.setItem("userId",e)})),n?this.updateUserInfo():this.register(),this.updateCosts(),this.updatePlaylist()}var e,n,r,a,s,o,c,u;return(0,k.Z)(t,[{key:"rootUrl",get:function(){var t;return null!==(t=window.apiRoot)&&void 0!==t?t:"/api"}},{key:"updateCosts",value:(u=(0,x.Z)(O().mark((function t(){var e,n,r=this;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(this.rootUrl,"/costs"));case 2:return e=t.sent,t.next=5,e.json();case 5:n=t.sent,(0,j.z)((function(){r.costs=n}));case 7:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"updateUserInfo",value:(c=(0,x.Z)(O().mark((function t(){var e,n,r,i=this;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(this.rootUrl,"/user/info"),{headers:{Authorization:"Bearer ".concat(this.userId)}});case 2:if((e=t.sent).ok){t.next=7;break}this.register(),t.next=12;break;case 7:return t.next=9,e.json();case 9:n=t.sent,r=new S(n),(0,j.z)((function(){i.userId==r.userId&&(i.userInfo=r)}));case 12:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"register",value:(o=(0,x.Z)(O().mark((function t(){var e,n,r=this;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(this.rootUrl,"/user/register"),{method:"POST"});case 2:return e=t.sent,t.next=5,e.json();case 5:n=t.sent,(0,j.z)((function(){var t=new S(n);r.userId=t.userId,r.userInfo=t}));case 7:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"updatePlaylist",value:(s=(0,x.Z)(O().mark((function t(){var e=this;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("".concat(this.rootUrl,"/playlist/current")).then((function(t){return t.json()})).then((0,j.aD)((function(t){var n;e.playlist=t.playlist.map((function(t){return new U(t)})),e.currentlyPlayingIndex=null!==(n=t.playingIndex)&&void 0!==n?n:-1}))));case 1:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"getSearchResults",value:(a=(0,x.Z)(O().mark((function t(e){var n,r,i;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new URLSearchParams({q:e}),t.next=3,fetch("".concat(this.rootUrl,"/search?").concat(n));case 3:return r=t.sent,t.next=6,r.json();case 6:return i=t.sent,t.abrupt("return",i.map((function(t){var e=new U(JSON.parse(t.data));return e._signedData=t,e})));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"queue",value:(r=(0,x.Z)(O().mark((function t(e){var n,r,i,a=this;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(this.rootUrl,"/playlist/queue"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.userId)}});case 2:if(400!==(n=t.sent).status&&409!==n.status){t.next=8;break}return t.next=6,n.json();case 6:throw r=t.sent,new Error(r.detail);case 8:return t.next=10,n.json();case 10:i=t.sent,(0,j.z)((function(){a.playlist=i.playlist.map((function(t){return new U(t)})),null!=i.playingIndex&&(a.currentlyPlayingIndex=i.playingIndex),i.userData&&(a.userInfo=new S(i.userData))}));case 12:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"queueNext",value:(n=(0,x.Z)(O().mark((function t(e){var n,r,i,a=this;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(this.rootUrl,"/playlist/queue-next"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.userId)}});case 2:if(400!==(n=t.sent).status&&409!==n.status){t.next=8;break}return t.next=6,n.json();case 6:throw r=t.sent,new Error(r.detail);case 8:return t.next=10,n.json();case 10:i=t.sent,(0,j.z)((function(){a.playlist=i.playlist.map((function(t){return new U(t)})),null!=i.playingIndex&&(a.currentlyPlayingIndex=i.playingIndex),i.userData&&(a.userInfo=new S(i.userData))}));case 12:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"skip",value:(e=(0,x.Z)(O().mark((function t(e){var n,r,i,a,s=this;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new URLSearchParams({current:e}),t.next=3,fetch("".concat(this.rootUrl,"/playlist/skip?").concat(n),{method:"POST",headers:{Authorization:"Bearer ".concat(this.userId)}});case 3:if(400!==(r=t.sent).status&&409!==r.status){t.next=9;break}return t.next=7,r.json();case 7:throw i=t.sent,new Error(i.detail);case 9:return t.next=11,r.json();case 11:a=t.sent,(0,j.z)((function(){s.playlist=a.playlist.map((function(t){return new U(t)})),null!=a.playingIndex&&(s.currentlyPlayingIndex=a.playingIndex),a.userData&&(s.userInfo=new S(a.userData))}));case 13:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),C=(0,r.kr)(new D),T=function(){return(0,r.qp)(C)},B=n(594),z=n(7320),A=(0,a.Pi)((function(t){var e,n,a=(0,h.Z)(),s=(0,l.s0)(),o=T(),c=(0,r.eJ)(""),u=(0,i.Z)(c,2),x=u[0],k=u[1];return(0,z.BX)(z.HY,{children:[(0,z.tZ)(d.Z,{styles:{"html, body":{height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"stretch"}}}),(0,z.tZ)(p.Z,{children:(0,z.BX)(f.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,z.tZ)("form",{onSubmit:function(t){return t.preventDefault(),s("/search",{state:{search:x}}),!1},style:{flexGrow:1,paddingRight:a.spacing(2)},children:(0,z.BX)(Z.Z,{sx:{backgroundColor:a.palette.background.paper,borderRadius:"16px",color:a.palette.text.secondary,display:"flex",alignItems:"center"},children:[(0,z.tZ)(w.Z,{sx:{lineHeight:0,marginLeft:"4px",marginRight:"4px"}}),(0,z.tZ)(y.ZP,{name:"search",placeholder:"Add song",sx:{overflow:"hidden",marginRight:"12px"},value:x,onChange:function(t){return k(t.target.value)}})]})}),(0,z.BX)(v.Z,{sx:{fontWeight:"bold",fontSize:"1.25em"},children:[(null!==(e=null===(n=o.userInfo)||void 0===n?void 0:n.credits)&&void 0!==e?e:0).toFixed(0),"Â¢"]})]})}),(0,z.tZ)(f.Z,{}),(0,z.tZ)(Z.Z,{sx:{flexGrow:1},children:t.children}),(0,z.tZ)(g.Z,{open:o.showToast,message:o.toastMessage,autoHideDuration:6e3,onClose:(0,j.aD)((function(){o.showToast=!1})),action:(0,z.tZ)(m.Z,{size:"small",onClick:(0,j.aD)((function(){o.showToast=!1})),color:"inherit",children:(0,z.tZ)(B.Z,{})})})]})})),R=function(){return(0,z.tZ)(A,{children:(0,z.tZ)(l.j3,{})})},X=n(2982),q=n(799),_=n(417),N=n(8584),E=n(2440),M=n(3193),H=n(1023),J=(0,a.Pi)((function(t){var e,n=t.result,r=t.onClick;return(0,z.BX)(q.ZP,{button:!0,onClick:r,children:[n.imageUrl&&(0,z.tZ)(_.Z,{sx:{marginRight:2},children:(0,z.tZ)("img",{src:n.imageUrl,alt:"",style:{width:"64px",height:"64px",display:"block"}})}),(0,z.tZ)(N.Z,{primary:"".concat(n.name||"Untitled Track"),secondary:"".concat(null!==(e=n.artist)&&void 0!==e?e:"Unknown Artist"," | ").concat(n.album||"Unknown Album")})]})})),L=(0,a.Pi)((function(t){var e=t.results,n=t.onClick;return(0,z.tZ)(E.Z,{children:e.map((function(t){var e;return(0,z.tZ)(J,{result:t,onClick:function(){n&&n(t)}},null!==(e=t.uri)&&void 0!==e?e:"")}))})})),Q=(0,a.Pi)((function(){var t,e,n,i,s,o,c,u=T(),h=(0,l.TH)(),d=(0,l.s0)(),Z=null!==(t=null===(e=h.state)||void 0===e?void 0:e.search)&&void 0!==t?t:"",y=(0,a.fv)((function(){return[]})),g=null===(n=h.state)||void 0===n?void 0:n.toQueue;return(0,r.d4)((function(){Z&&u.getSearchResults(Z).then((0,j.aD)((function(t){y.splice(0,y.length),y.splice.apply(y,[0,0].concat((0,X.Z)(t)))})))}),[Z]),(0,z.BX)(z.HY,{children:[(0,z.tZ)(p.Z,{children:(0,z.BX)(f.Z,{children:[(0,z.tZ)(m.Z,{edge:"start",onClick:function(){d(-1)},color:"inherit",children:(0,z.tZ)(H.Z,{})}),(0,z.tZ)(v.Z,{variant:"h6",children:"Search Results"})]})}),(0,z.tZ)(f.Z,{}),(0,z.tZ)(L,{results:y,onClick:function(t){d(h.pathname,{state:{toQueue:(0,j.ZN)(t),search:Z}})}}),(0,z.tZ)(M.Z,{open:!!g,onClose:function(){d(-1)},children:(0,z.BX)(E.Z,{children:[(0,z.tZ)(q.ZP,{button:!0,onClick:function(){g&&g._signedData&&(u.queue(g._signedData).then((function(){})).catch((0,j.aD)((function(t){u.toastMessage=t.toString(),u.showToast=!0}))),d("/",{replace:!0}))},children:(0,z.tZ)(N.Z,{primary:"Queue",secondary:"".concat(null!==(i=null===(s=u.costs)||void 0===s?void 0:s.queue)&&void 0!==i?i:1," credits")})}),(0,z.tZ)(q.ZP,{button:!0,onClick:function(){g&&g._signedData&&(u.queueNext(g._signedData).then((function(){})).catch((0,j.aD)((function(t){u.toastMessage=t.toString(),u.showToast=!0}))),d("/",{replace:!0}))},children:(0,z.tZ)(N.Z,{primary:"Queue Next",secondary:"".concat(null!==(o=null===(c=u.costs)||void 0===c?void 0:c.queueNext)&&void 0!==o?o:1," credits")})})]})})]})}));function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){(0,I.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var F=(0,a.Pi)((function(t){var e,n,r,i=t.track,a=t.playing,s=void 0!==a&&a,o=t.onClick,c={};return s&&(c.button=!0),(0,z.BX)(q.ZP,Y(Y({},c),{},{sx:{backgroundColor:s?"#333333":void 0},onClick:o,children:[i.imageUrl&&(0,z.tZ)(_.Z,{sx:{marginRight:2},children:(0,z.tZ)("img",{src:i.imageUrl,alt:"",style:{width:"64px",height:"64px",display:"block"}})}),(0,z.tZ)(N.Z,{primary:"".concat(null!==(e=i.name)&&void 0!==e?e:"Untitled Track"),secondary:"".concat(null!==(n=i.artist)&&void 0!==n?n:"Unknown Artist"," | ").concat(null!==(r=i.album)&&void 0!==r?r:"Unknown Album")})]}))})),G=(0,a.Pi)((function(){var t,e,n,r=T(),i=(0,l.TH)(),a=(0,l.s0)(),s=null===(t=i.state)||void 0===t?void 0:t.skipUri;return(0,z.BX)(z.HY,{children:[(0,z.tZ)(E.Z,{children:r.playlist.map((function(t,e){return(0,z.tZ)(F,{track:t,playing:r.currentlyPlayingIndex==e,onClick:r.currentlyPlayingIndex==e?function(){var t=r.playlist[e].uri;a(i.pathname,{state:{skipUri:t}})}:void 0},t.uri)}))}),(0,z.tZ)(M.Z,{open:!!s,onClose:function(){a(-1)},children:(0,z.tZ)(E.Z,{children:(0,z.tZ)(q.ZP,{button:!0,onClick:function(){s&&r.skip(s).then((function(){})).catch((0,j.aD)((function(t){r.showToast=!0,r.toastMessage=t.toString()}))),a(-1)},children:(0,z.tZ)(N.Z,{primary:"Skip",secondary:"".concat(null!==(e=null===(n=r.costs)||void 0===n?void 0:n.skip)&&void 0!==e?e:1," credits")})})})})]})})),K=(0,s.Z)({palette:{primary:{main:"#ffcc00"},mode:"dark"}}),V=(0,a.Pi)((function(){var t=(0,r.eJ)((function(){return new D})),e=(0,i.Z)(t,1)[0];return(0,r.d4)((function(){var t=window.setInterval((function(){e.updatePlaylist(),e.userId&&e.updateUserInfo()}),8e3);return function(){window.clearTimeout(t)}}),[]),(0,z.BX)(o.Z,{theme:K,children:[(0,z.tZ)(c.ZP,{}),(0,z.tZ)(C.Provider,{value:e,children:(0,z.tZ)(u.UT,{children:(0,z.BX)(l.Z5,{children:[(0,z.tZ)(l.AW,{element:(0,z.tZ)(R,{}),children:(0,z.tZ)(l.AW,{path:"/",element:(0,z.tZ)(G,{})})}),(0,z.tZ)(l.AW,{path:"/search",element:(0,z.tZ)(Q,{})})]})})})]})})),$=document.getElementsByTagName("body")[0],tt=(0,z.tZ)(V,{});window.addEventListener("load",(function(){(0,r.sY)(tt,$)}))}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var a=n[t]={exports:{}};return e[t](a,a.exports,r),a.exports}r.m=e,t=[],r.O=(e,n,i,a)=>{if(!n){var s=1/0;for(l=0;l<t.length;l++){for(var[n,i,a]=t[l],o=!0,c=0;c<n.length;c++)(!1&a||s>=a)&&Object.keys(r.O).every((t=>r.O[t](n[c])))?n.splice(c--,1):(o=!1,a<s&&(s=a));if(o){t.splice(l--,1);var u=i();void 0!==u&&(e=u)}}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[n,i,a]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={179:0};r.O.j=e=>0===t[e];var e=(e,n)=>{var i,a,[s,o,c]=n,u=0;if(s.some((e=>0!==t[e]))){for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(c)var l=c(r)}for(e&&e(n);u<s.length;u++)a=s[u],r.o(t,a)&&t[a]&&t[a][0](),t[s[u]]=0;return r.O(l)},n=self.webpackChunkchunes=self.webpackChunkchunes||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var i=r.O(void 0,[947],(()=>r(263)));i=r.O(i)})();